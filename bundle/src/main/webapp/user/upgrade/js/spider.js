if(typeof COASE.modules=="undefined"){throw new Error("Error:coaseClass is undefined!")}COASE.modules.spider=function(A,B){isCoaseCompleted=true;A=A||"";B=B||{};switch(A){case"common":spiderClass.common(B);break;default:break}};COASE.regExp={regs:{offerRegs:[/^.*offerdetail\/([\w\/\-]+\-)?(\d+)\.html/i],companyRegs:[/^http:\/\/(\s+)?(\w+).cn.alibaba.com(\/)(\?.*)?$/i,/^.+\.alibaba\.com\/(company\/detail)\/([\w\d]+)\.html/i]},getOfferRegs:function(A){return{a:[COASE.regExp.regs.offerRegs[0]]}[A||""]||[]},getCompanyRegs:function(A){return{a:[COASE.regExp.regs.companyRegs[0]],b:[COASE.regExp.regs.companyRegs[1]],c:[COASE.regExp.regs.companyRegs[0],COASE.regExp.regs.companyRegs[1]]}[A||""]||[]}};var spiderClass={_doClick:function(D,B){var F=COASE;var A=new F.getUrlParams(D);A.page_id=F.util.getPageId();A.refer=escape(document.location.href);B=B||{};A=F.lang.merge(A,B);var E=F.util.substitute(F.coaseConfig.api,A);F.coaseClick(E)},common:function(B){if(B.ctrType){B.ctr_type=B.ctrType.toString()}var A=this;this._company(B);setTimeout(function(){A._offer(B)},150)},_company:function(E){if(E.isCompanyCoaseOut||E.isCoaseOut){return}var C=E.companyRange||["document"];E.companyRegType=E.companyRegType||"c";var D=COASE.regExp.getCompanyRegs(E.companyRegType)||[];var A=this._getLinksIds(C,D,5,true,E.filterTag);if(A!=""){A+=";"}else{return}var B={object_ids:A,object_type:"company"};this._doClick(E,B)},_offer:function(E){if(E.isOfferCoaseOut||E.isCoaseOut){return}var A=E.offerRange||["document"];E.offerRegType=E.offerRegType||"a";var D=COASE.regExp.getOfferRegs(E.offerRegType)||[];var B=this._getLinksIds(A,D,5,true,E.filterTag);if(B!=""){B+=";"}else{return}var C={object_ids:B,object_type:"offer"};this._doClick(E,C)},_getLinksIds:function(P,B,K,L,Q){var A=[];var C=[];var M=[];var I=COASE.util;var O;for(var H=0,E=P.length;H<E;H++){if(I.get(P[H])==null){continue}A=I.get(P[H]).getElementsByTagName("a");for(var G=0,J=A.length;G<J;G++){if(A[G].getAttribute(Q)||(!A[G].getAttribute("href",2))||A[G].getAttribute("href",2)=="#"){continue}for(var F=0,N=B.length;F<N;F++){if(L){var D=B[F].exec(A[G].href)||[];O=D[2];if(!O){continue}if(I._arrayLastIndexOf(C,O,C.length-1)==-1){C[C.length]=O;M[M.length]=O+","+K}}else{!!B[F].exec(A[G].href)?M[M.length]=(RegExp.$2+","+K):""}}}}C=null;A=null;return M.join(";")}};
